---
layout: post
title: "[TIL] 2022-11-02"
author: deBaeloper08
date: 2022-11-02 22:26:00 +0900
categories: [TIL]
tags: [asnyc, withContext, invoke, patterns]
---

## ğŸ˜² ì˜¤ëŠ˜ì˜ ê°œë°œ ì¼ì§€

---

- asyncì™€ withContextëŠ” ê¸°ëŠ¥ë©´ì—ì„œëŠ” ë™ì¼í•˜ë‹¤. í•˜ì§€ë§Œ **ì¡°ê¸ˆì˜ ì°¨ì´ì **ì´ ìˆë‹¤.

  - asyncëŠ” ë³‘ë ¬ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê³  withContextëŠ” ê·¸ëŸ¬ì§€ ëª»í•œë‹¤.

  ```kotlin
  suspend fun exampleSuspend() {
      withContext(Dispatchers.IO) {
          delay(1000)
      }

      withContext(Dispatchers.IO) {
          delay(1000)
      }

      withContext(Dispatchers.IO) {
          delay(1000)
      }
  }
  ```

  withContextëŠ” ìœ„ ì½”ë“œê°€ ëª¨ë‘ ì‹¤í–‰ë˜ëŠ”ë° 3ì´ˆê°€ ê±¸ë¦°ë‹¤.

  ```kotlin
  suspend fun test() {
      CoroutineScope(Dispatchers.IO).async {
          delay(1000)
      }

      CoroutineScope(Dispatchers.IO).async {
          delay(1000)
      }

      CoroutineScope(Dispatchers.IO).async {
          delay(1000)
      }
  }
  ```

  asyncëŠ” ë³‘ë ¬ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ê¸°ì— ì½”ë“œê°€ ëª¨ë‘ ì‹¤í–‰ë˜ëŠ”ë°ê¹Œì§€ 1ì´ˆê°€ ê±¸ë¦°ë‹¤.

  - asyncëŠ” try-catchë¬¸ì´ ì˜ˆì™¸ë¥¼ ì¡ì§€ ëª»í•˜ì§€ë§Œ withContextëŠ” ì˜ˆì™¸ë¥¼ ì¡ì„ ìˆ˜ ìˆë‹¤.

    asyncëŠ” exceptionì´ ë°œìƒí•˜ëŠ” ë¶€ë¶„ì—ì„œ try-catchë¬¸ì„ ì‚¬ìš©í•´ë„ í•´ë‹¹ ì½”ë£¨í‹´ì„ ì‹¤í–‰ì‹œí‚¨ CoroutineScopeì—ë„ ì˜ˆì™¸ê°€ ì „ë‹¬ëœë‹¤.

  ```kotlin
  CoroutineScope(Dispatchers.IO).launch { // 2. ì—¬ê¸°ê¹Œì§€ ì—ëŸ¬ê°€ ì „ë‹¬ëœë‹¤.
          try {
              async {
                  throw Exception() // 1. ì—¬ê¸°ì„œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ë©´
              }
          } catch (e: Exception) {
              println("error catch")
          }
      }
  ```

  ê·¸ë˜ì„œ ìœ„ ì½”ë“œëŠ” ì‹¤í–‰ì‹œí‚¤ì§€ ëª»í•˜ê³  ì•±ì´ ì£½ì–´ë²„ë¦°ë‹¤.

  ```kotlin
  CoroutineScope(Dispatchers.IO).launch {
          try {
              withContext(Dispatchers.Default) {
                  throw Exception()
              }
          } catch (e: Exception) {
              println("error catch")
          }
      }
  ```

  ë°˜ë©´ withContextëŠ” ì˜ˆì™¸ê°€ ì „ë‹¬ë˜ì§€ ì•Šì•„ Exceptionì„ ì¡ì•„ë‚¸ë‹¤.

- ì½”í‹€ë¦°ì—ëŠ” invokeë¼ëŠ” ì—°ì‚°ìê°€ ì¡´ì¬í•œë‹¤.

  `invoke` ì—°ì‚°ìëŠ” ì´ë¦„ ì—†ì´ í˜¸ì¶œ ë  ìˆ˜ ìˆë‹¤.

  ```kotlin
  object MyFunction {
  operator fun invoke(str: String): String {
      return str.toUpperCase() // ëª¨ë‘ ëŒ€ë¬¸ìë¡œ ë°”ê¿”ì¤Œ
      }
  }

  MyFunction.invoke("hello")
  ```

- flow ë„ˆë¬´ ì–´ë µë‹¤ã… ã… ã… 

  flowëŠ” ì™œ ì“°ëŠ”ê±¸ã„²r....

- ì•ˆë“œë¡œì´ë“œ ë‚´ë¶€ í•¨ìˆ˜ì— ì´ë©”ì¼ í˜•ì‹ì„ ì²´í¬í•´ì£¼ëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤.

  ì•„ì´ë””ë¥¼ ì´ë©”ì¼ í˜•ì‹ìœ¼ë¡œ ë°›ì•„ì•¼í•´ì„œ ì •ê·œì‹ì„ ê²€ìƒ‰í•˜ë˜ ì¤‘ ì•Œê²Œ ëë‹¤.

  ```kotlin
  private fun isCorrectEmailPattern(name: String): Boolean {
      if (name.isEmpty())
          return false

      return Patterns.EMAIL_ADDRESS.matcher(name).matches()
  }
  ```
